"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define(["mod_treasurehunt/ol"],t):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=t(require("mod_treasurehunt/ol")):e.LayerSwitcher=t(e.ol)}(void 0,function(h){return h.control.LayerSwitcher=function(e){var t=e||{},n=t.tipLabel?t.tipLabel:"Legend";this.mapListeners=[],this.hiddenClassName="ol-unselectable ol-control layer-switcher",h.control.LayerSwitcher.isTouchDevice_()&&(this.hiddenClassName+=" touch"),this.shownClassName="shown";var o=document.createElement("div");o.className=this.hiddenClassName;var r=document.createElement("button");r.setAttribute("title",n),o.appendChild(r),this.panel=document.createElement("div"),this.panel.className="panel",o.appendChild(this.panel),h.control.LayerSwitcher.enableTouchScroll_(this.panel);var i=this;r.onmouseover=function(e){i.showPanel()},r.onclick=function(e){e=e||window.event,i.showPanel(),e.preventDefault()},i.panel.onmouseout=function(e){e=e||window.event,i.panel.contains(e.toElement||e.relatedTarget)||i.hidePanel()},h.control.Control.call(this,{element:o,target:t.target})},h.inherits(h.control.LayerSwitcher,h.control.Control),h.control.LayerSwitcher.prototype.showPanel=function(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.renderPanel())},h.control.LayerSwitcher.prototype.hidePanel=function(){this.element.classList.contains(this.shownClassName)&&this.element.classList.remove(this.shownClassName)},h.control.LayerSwitcher.prototype.renderPanel=function(){for(this.ensureTopVisibleBaseLayerShown_();this.panel.firstChild;)this.panel.removeChild(this.panel.firstChild);var e=document.createElement("ul");this.panel.appendChild(e),this.renderLayers_(this.getMap(),e)},h.control.LayerSwitcher.prototype.setMap=function(e){for(var t,n=0;n<this.mapListeners.length;n++)h.Observable.unByKey(this.mapListeners[n]);this.mapListeners.length=0,h.control.Control.prototype.setMap.call(this,e),e&&((t=this).mapListeners.push(e.on("pointerdown",function(){t.hidePanel()})),this.renderPanel())},h.control.LayerSwitcher.prototype.ensureTopVisibleBaseLayerShown_=function(){var o;h.control.LayerSwitcher.forEachRecursive(this.getMap(),function(e,t,n){"base"===e.get("type")&&e.getVisible()&&(o=e)}),o&&this.setVisible_(o,!0)},h.control.LayerSwitcher.prototype.setVisible_=function(o,e){var t=this.getMap();o.setVisible(e),e&&"base"===o.get("type")&&h.control.LayerSwitcher.forEachRecursive(t,function(e,t,n){e!=o&&"base"===e.get("type")&&e.setVisible(!1)})},h.control.LayerSwitcher.prototype.renderLayer_=function(t,e){var n,o,r,i=this,a=document.createElement("li"),s=t.get("title"),c=h.control.LayerSwitcher.uuid(),l=document.createElement("label");return t.getLayers&&!t.get("combine")?(a.className="group",l.innerHTML=s,a.appendChild(l),n=document.createElement("ul"),a.appendChild(n),this.renderLayers_(t,n)):(a.className="layer",o=document.createElement("input"),"base"===t.get("type")?(o.type="radio",o.name="base"):o.type="checkbox",o.id=c,o.checked=t.get("visible"),o.onchange=function(e){i.setVisible_(t,e.target.checked)},a.appendChild(o),l.htmlFor=c,l.innerHTML=s,((r=this.getMap().getView().getResolution())>t.getMaxResolution()||r<t.getMinResolution())&&(l.className+=" disabled"),a.appendChild(l)),a},h.control.LayerSwitcher.prototype.renderLayers_=function(e,t){for(var n,o=e.getLayers().getArray().slice().reverse(),r=0;r<o.length;r++)(n=o[r]).get("title")&&t.appendChild(this.renderLayer_(n,r))},h.control.LayerSwitcher.forEachRecursive=function(e,o){e.getLayers().forEach(function(e,t,n){o(e,t,n),e.getLayers&&h.control.LayerSwitcher.forEachRecursive(e,o)})},h.control.LayerSwitcher.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},h.control.LayerSwitcher.enableTouchScroll_=function(e){var t;h.control.LayerSwitcher.isTouchDevice_()&&(t=0,e.addEventListener("touchstart",function(e){t=this.scrollTop+e.touches[0].pageY},!1),e.addEventListener("touchmove",function(e){this.scrollTop=t-e.touches[0].pageY},!1))},h.control.LayerSwitcher.isTouchDevice_=function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}},h.control.LayerSwitcher});
//# sourceMappingURL=ol3-layerswitcher.min.js.map
